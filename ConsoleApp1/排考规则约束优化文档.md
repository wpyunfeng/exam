# 排考规则

## 1. 班级分配考场规则

- **规则 1：班级分配顺序和拆分规则**
  - 按班级顺序分配考场。
  - 若考场无法容纳完整班级的学生，允许将班级拆分，并均衡分配至多个相邻考场。
  - 如果一个班级需要多个考场，这些考场必须在同一个教学楼（即 `AIExamModelRoom.BuildingId` 相同），并且尽量相邻。

- **规则 2：考场多班级安排**
  - 一个考场可以安排多个班级，但要求每个考场内的班级来自不同年级。
  - 每个考场最多只能安排 2 个不同年级的班级。

- **规则 3：优先选择匹配的考场**
  - 班级年级越大，越优先选择座位数与班级人数最匹配的考场，但班级人数不得超过考场的最大容量。
  - 如果多个考场适配该班级，优先选择较小的考场，以最大化座位利用率。

- **规则 4：确保座位充足**
  - 每个考场的座位数必须大于或等于分配给该考场的学生人数，确保座位数足够，避免座位短缺。

- **规则 5：固定考场分配与调整**
  - 原则上，班级的考场分配应保持固定不变。
  - 如果班级对应的某个考试科目无法安排考试时间，可以单独为该科目重新安排考场。
  - 如果班级只对应一个考场，重新安排该考场；如果班级对应多个考场，则所有考场都需要重新安排，并且尽量选择相邻的考场。

- **规则 6：考场均衡分配**
  - 确保考场分配均衡，最大限度地减少考场空闲时间和未使用的座位。
 
2. 排考规则
   规则 1:
   考试科目的考试形式（ExamMode）必须与考场的考试形式匹配。例如，笔试科目只能安排在有桌椅的考场，机试科目只能安排在有计算机的考场。
   规则 2:
   同一考试科目的所有班级必须在同一时间进行考试。(该规则必须满足)
   规则 3：
   同一考场在同一时间只能安排一个班级考试
   规则 4:
   在安排考试时，优先安排优先级（Priority）较高的科目。若优先级相同，则按考试时长（Duration）排序。
   规则 5:
   每场考试的时长必须与科目规定的时长一致。系统将根据科目的时长自动调整考试场次。
   规则 6:
   每场考试的安排必须严格限制在有效的考试日期范围内（ModelTimeList.Date）。
   规则 7:
   每个班级每天的考试场次不得超过 AIExamConfig.MaxStudentDaily 限制，避免安排过度。
   规则 8:
   系统将尽量保证班级的考试科目均匀分布，避免某些班级在短时间内集中安排多场考试，减少学生过度疲劳的风险。
   规则 10:
   AIExamModelTime 数组中相同日期（Date）和时间段（TimeNo）的时间段视为同一个考试场次。一个场次下，一个考场可以安排多门考试科目，但需遵守以下约束：
   1. 同一考试场次内允许安排两个或 2 个以上的不同的考试科目，但这些科目对应的班级不能相同（即同一班级不能连续参加考试），并且考试之间必须至少间隔 AIExamConfig.MinExamInterval 分钟。
   2. 同一考试场次内的所有考试必须在考试场次范围 AIExamModelTime.StartTime 至 AIExamModelTime.EndTime 内完成
   3. 同一考试场次内的考试必须严格避免时间重叠。
 

3. 监考教师分配规则优化
   规则 1:
   每个考场的监考教师数量由 AIExamModelRoom.TeacherCount 控制。如果 TeacherCount = 3，则分配 3 名监考教师到该考场。
   规则 1:
   每位监考教师在一天内只安排在一个考场上，且考场会根据教师的性别比例进行合理分配。隔天重新分配监考教师。
   规则 1:
   确保同一监考教师在同一时间只安排在一个考场进行监考。这是核心约束条件，需要在教师分配时确保不发生时间重叠。
   规则 1:
   为避免个别教师负担过重，尽量实现监考教师的均衡分配。可以按照监考任务的数量，优先分配任务少的教师。
   规则 1:
   尽量确保每个考场的监考教师性别平衡。根据考场需要的教师数量，安排尽量相等数量的男教师和女教师。
