在 AIExamHelper.cs 文件里的 AutoScheduler 方法实现自动排考，
使用 C# .net8.0,基于 Google.OrTools 9.14.6206 版本实现自动排考，
根据我的排考规则生成代码
我的排考规则及要求如下：

# 排考规则

## 1. 班级分配考场规则：

- **规则 1：班级分配顺序与拆分规则**

  - 按照班级的顺序分配考场，确保考场的安排尽量顺畅。
  - 当单个考场无法容纳完整班级的学生时，允许将该班级拆分，并将学生均衡地分配到多个相邻的考场。
  - 如果一个班级需要多个考场，确保这些考场位于同一教学楼内（`AIExamModelRoom.BuildingId`相同），并且尽量安排在相邻位置，方便班级的监考安排。

- **规则 2：考场多班级安排**

  - 一个考场可以容纳多个班级，但必须确保每个班级来自不同年级。
  - 每个考场最多只能安排 2 个不同年级的班级，以避免资源冲突，确保安排的合理性。

- **规则 3：优先匹配适配的考场**

  - 对于年级较大的班级，应优先选择座位数与班级人数最匹配的考场。
  - 但班级人数不得超过考场的最大容量，确保每个班级能够顺利完成考试。
  - 若有多个适合的考场，优先选择较小的考场，从而提高座位的利用率，避免浪费。

- **规则 4：确保座位充足**

  - 每个分配给班级的考场，必须具备足够的座位，确保学生人数不超过座位容量。
  - 如果考场座位数不足，将不能满足该班级的安排需求，必须重新安排考场。

- **规则 5：固定考场与例外调整**

  - 原则上，每个班级的考场分配是固定的，除非在某个考试科目无法安排适合的时间时，才可以调整该科目的考场。
  - 若班级仅需一个考场，则仅调整该考场；如果班级对应多个考场，则需调整所有这些考场，并尽量确保调整后的考场是相邻的。

- **规则 6：均衡考场分配**
  - 在安排考场时，要尽可能保证每个考场的分配是均衡的，减少考场空闲的情况。
  - 确保所有考场的资源得到有效利用，避免出现空闲座位浪费。

## 考试科目安排考试时间规则

- **规则 1：考试科目与考场匹配**

  - 考试科目的考试形式（`ExamMode`）必须与考场的考试形式匹配。
  - 例如，笔试科目只能安排在有桌椅的考场，机试科目只能安排在有计算机的考场。

- **规则 2：考试时间安排**

  - 同一考试科目的所有班级必须在同一时间进行考试，该规则必须严格遵守，确保同一科目的考试不会错开时间。
  - 同一考场在同一时间只能安排一个班级的考试，这样可以避免考场内的班级冲突，确保每个班级有足够的空间进行考试。

- **规则 4：优先级和考试时长**

  - 在安排考试时，优先安排优先级（`Priority`）较高的科目。如果多个科目的优先级相同，则按考试时长（`Duration`）进行排序，确保较短时长的考试不会拖延较长时长的考试。
  - 每场考试的时长必须与科目规定的时长一致。系统会根据科目的时长自动调整考试场次，以确保考试时间的精确性。

- **规则 6：考试日期与考场分配**

  - 每场考试的安排必须严格限制在有效的考试日期范围内（`ModelTimeList.Date`）。确保所有考试安排在合法的考试日期范围内进行。
  - 每个班级每天的考试场次不得超过 `AIExamConfig.MaxStudentDaily` 限制，避免安排过多考试，导致学生过度疲劳。
  - 系统将尽量保证班级的考试科目均匀分布，避免某些班级在短时间内集中安排多场考试，从而减少学生过度疲劳的风险。

- **规则 10：考试场次与间隔**

  - 在 `AIExamModelTime` 数组中，相同日期（`Date`）和时间段（`TimeNo`）的时间段视为同一个考试场次。
  - 一个考试场次下，一个考场可以安排多门考试科目，但需遵守以下约束：
    1. 同一考试场次内允许安排两个或更多不同的考试科目，但这些科目对应的班级不能相同（即同一班级不能连续参加考试）。考试之间必须至少间隔 `AIExamConfig.MinExamInterval` 分钟。
    2. 同一考试场次内的所有考试必须在考试场次范围 `AIExamModelTime.StartTime` 至 `AIExamModelTime.EndTime` 内完成。
    3. 同一考试场次内的考试必须严格避免时间重叠。

- **规则 11：调整考试时间**
  - 如果某个考试科目对应的班级无法安排适合的考试时间，可以单独为该考试科目的班级重新安排考场。
  - 如果班级只对应一个考场，则仅更改一个考场；如果班级对应多个考场，则需要更改所有对应的考场，并尽量选择相邻的考场。

## 监考教师分配规则

- **规则 1：监考教师数量与分配**

  - 每个考场的监考教师数量由 `AIExamModelRoom.TeacherCount` 控制。比如 `TeacherCount = 3`，则需要分配 3 名监考教师到该考场。

- **规则 2：教师分配与性别平衡**

  - 每位监考教师在一天内只能安排在一个考场进行监考。
  - 且每个考场的监考教师会根据教师的性别比例进行合理分配，确保性别平衡。

- **规则 3：监考教师的时间重叠**

  - 确保同一监考教师在同一时间只能在一个考场进行监考。这是一个核心约束条件，必须在教师分配过程中避免时间重叠，确保每位教师在同一时间段只承担一个考场的监考任务。

- **规则 4：监考教师均衡分配**

  - 为避免个别教师负担过重，监考教师应尽量均衡分配。
  - 可以根据教师的监考任务数量，优先分配任务较少的教师，确保任务量的公平分配。

- **规则 5：考场监考教师性别平衡**
  - 尽量确保每个考场的监考教师性别平衡。
  - 根据考场所需的监考教师数量，安排尽量相等数量的男教师和女教师，确保性别比例的合理性。

## 二级约束（软约束）

- **同时考试的科目**（RuleJointSubjectList）

  - 某些考试科目必须在同一时间开始。例如，科目 ID 为 1、2、3 的科目必须在 2025-09-26 08:30 同时开始考试，虽然结束时间可以不同，但开始时间必须相同。

- **不能同时考试的科目**（RuleJointSubjectNotList）

  - 某些考试科目不能在同一时间进行。例如，科目 ID 为 1、2、3 不能与科目 ID 为 4、5 同时安排考试。

- **考试科目预分配考场**（RuleRoomSubjectList）

  - 某些考试科目只能安排在特定的考场进行。例如，科目 ID 为 2 只能在考场 ID 为 1 进行考试。

- **考试科目禁止分配考场**（RuleRoomSubjectNotList）

  - 某些考试科目不能安排在特定的考场进行。例如，科目 ID 为 2 不能在考场 ID 为 1 进行考试。

- **教师预监考教学楼**（RuleTeacherBuildingList）

  - 某些教师只能在特定教学楼的考场监考。例如，教师 ID 为 1 只能在教学楼 ID 为 2 或 3 内监考。

- **教师禁用教学楼**（RuleTeacherBuildingNotList）

  - 某些教师不能在特定的教学楼监考。例如，教师 ID 为 1 不能在教学楼 ID 为 2 内监考。

- **教师预监考教学楼**（RuleTeacherClassList）

  - 某些教师只能监考特定班级。例如，教师 ID 为 1 只能监考班级 ID 为 2 和 3。

- **教师禁止预监考教学楼**（RuleTeacherClassNotList）

  - 某些教师不能监考特定班级。例如，教师 ID 为 1 不能监考班级 ID 为 2 和 3。

- **教师预监考考试科目**（RuleTeacherSubjectList）

  - 某些教师只能监考特定科目。例如，教师 ID 为 1 只能监考科目 ID 为 2 和 3。

- **教师禁止监考考试科目**（RuleTeacherSubjectNotList）

  - 某些教师不能监考特定科目。例如，教师 ID 为 1 不能监考科目 ID 为 2 和 3。

- **教师不可监考时间段**（RuleTeacherUnTimeList）
  - 某些教师在特定时间段不能监考。例如，教师 ID 为 1 在 2025-09-26 08:00 至 2025-09-26 13:00 期间不能监考。
